
# ASK‚ÄëWIZARD v3 ‚Äî –ï–¥–∏–Ω—ã–π –ø–æ—Ç–æ–∫ (Memory –≤–Ω—É—Ç—Ä–∏ ASK)

–¶–µ–ª—å: **—É–±—Ä–∞—Ç—å —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω–æ—Å—Ç—å** –º–µ–∂–¥—É Memory –∏ ASK, –æ—Å—Ç–∞–≤–∏—Ç—å _–æ–¥–∏–Ω_ –º–∞—Å—Ç–µ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤ (ASK‚ÄëWIZARD),
–≤ –∫–æ—Ç–æ—Ä–æ–º: –≤—ã–±–æ—Ä/–ø–æ–∏—Å–∫/–ø–∞–≥–∏–Ω–∞—Ü–∏—è/—É–¥–∞–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ, **–±–µ–∑ LLM**,
—Å –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–º —Ç—É–º–±–ª–µ—Ä–æ–º `‚ûï/‚úÖ` –∏ ¬´—á–∏—Å—Ç—ã–º —ç–∫—Ä–∞–Ω–æ–º¬ª.

---

## 0) Scope / Non‚ÄëScope

**Scope**
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ Memory‚ÄëList –≤ ASK‚ÄëWIZARD (–µ–¥–∏–Ω—ã–π UI).
- –ü–µ—Ä–µ–Ω–æ—Å –ø–æ–∏—Å–∫–∞ –≤ —ç–∫—Ä–∞–Ω List (–≤ —à–∞–ø–∫—É).
- –ü–ª–∞—à–∫–∏ + 1 —Å—Ç—Ä–æ–∫–∞ –∫–Ω–æ–ø–æ–∫, –ø–∞–≥–∏–Ω–∞—Ü–∏—è 5/—Å—Ç—Ä–∞–Ω–∏—Ü–∞.
- –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —Ç—É–º–±–ª–µ—Ä –≤—ã–±–æ—Ä–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞.
- –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤/linked‚Äë–ø—Ä–æ–µ–∫—Ç–æ–≤ (read‚Äëonly).
- –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ Reply‚Äë–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–∫–æ—Ä–æ—Ç–∫–∞—è, –±–µ–∑ Memory).
- –ê–≤—Ç–æ‚Äëclean, –±—é–¥–∂–µ—Ç–Ω–∞—è –ø–ª–∞—à–∫–∞, —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —à–∞–≥–∞—Ö.

**–ù–µ Scope**
- –õ—é–±–∞—è —Ä–∞–±–æ—Ç–∞ LLM (–∑–∞–ø—Ä–µ—Ç –≤ —ç—Ç–æ–º –ø–æ—Ç–æ–∫–µ).
- –ë–∏–∑–Ω–µ—Å‚Äë–ª–æ–≥–∏–∫–∞ –≤–Ω–µ ASK/–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤/–ø—Ä–æ–µ–∫—Ç–æ–≤.

---

## 1) Reply‚Äë–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ (persistent)

–û—Å—Ç–∞–≤–∏—Ç—å **3 –∫–æ—Ä–æ—Ç–∫–∏–µ –∫–Ω–æ–ø–∫–∏** (–ø—Ä–∏–º–µ—Ä):
- `‚öôÔ∏è Actions` ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–∫–∞–∫ —Å–µ–π—á–∞—Å).
- `üí¨ Chat: ON/OFF` ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —á–∞—Ç–∞.
- `‚ùì ASK‚ÄëWIZARD` ‚Äî –≤—Ö–æ–¥ –≤ –µ–¥–∏–Ω—ã–π –º–∞—Å—Ç–µ—Ä.

**Memory** –∏–∑ Reply‚Äë–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —É–±—Ä–∞—Ç—å (–≤—Å—Ç—Ä–æ–µ–Ω–æ –≤ ASK).  
–ö–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–µ—Ä–∂–∏—Ç –µ–¥–∏–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è‚Äë–¥–µ—Ä–∂–∞—Ç–µ–ª—å, –≤—Å–µ–≥–¥–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ.

---

## 2) –í—Ö–æ–¥ –≤ ASK‚ÄëWIZARD (–¥–æ–º–∞—à–Ω—è—è –ø–∞–Ω–µ–ª—å)

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `üîç –ü–æ–∏—Å–∫` (–ø–µ—Ä–µ–≤–µ–¥—ë–Ω –≤–Ω—É—Ç—Ä—å List; –∫–Ω–æ–ø–∫–∞ –≤–µ–¥—ë—Ç –≤ —ç–∫—Ä–∞–Ω List –∏ —Ç–∞–º –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç ForceReply).
- `‚ùì Ask` (–ø–æ—è–≤–ª—è–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ** –µ—Å–ª–∏ –µ—Å—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏).
- `Auto‚Äëclear: ON/OFF`
- `üßπ –°–±—Ä–æ—Å` (–æ—á–∏—Å—Ç–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏)
- `üì• Import last` (–±—ã—Å—Ç—Ä—ã–π –∏–º–ø–æ—Ä—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ñ–∞–π–ª–∞)
- –ü–ª–∞—à–∫–∞ **¬´–ë—é–¥–∂–µ—Ç: ~N —Ç–æ–∫–µ–Ω–æ–≤¬ª** (–æ—Ü–µ–Ω–∫–∞ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º)
- –¢–µ–∫—Å—Ç‚Äë–ø–æ–¥—Å–∫–∞–∑–∫–∞: —á—Ç–æ —Å–µ–π—á–∞—Å –≤—ã–±—Ä–∞–Ω–æ / —á—Ç–æ –¥–∞–ª—å—à–µ —Å–¥–µ–ª–∞—Ç—å.

---

## 3) –≠–∫—Ä–∞–Ω **List** (—Å–µ—Ä–¥—Ü–µ –º–∞—Å—Ç–µ—Ä–∞)

### 3.1 –®–∞–ø–∫–∞
- –ü–ª–∞—à–∫–∞ ¬´–ù–∞–π—Ç–∏ –∏—Å—Ç–æ—á–Ω–∏–∫¬ª –∏ –∫–Ω–æ–ø–∫–∞ `üîç` ‚Üí ForceReply ¬´–≤–≤–µ–¥–∏—Ç–µ –∏–º—è, #—Ç–µ–≥ –∏–ª–∏ id¬ª.
- –ü—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º –ø–æ–∏—Å–∫–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —á–∏–ø `–ü–æ–∏—Å–∫: "<term>"` + –∫–Ω–æ–ø–∫—É `‚úñ –û—á–∏—Å—Ç–∏—Ç—å` (—Å–±—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–∞).

### 3.2 –¢–µ–ª–æ (—Å–ø–∏—Å–æ–∫)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º **5 –ø–ª–∞—à–µ–∫** (–ø–æ 1 —Å–æ–æ–±—â–µ–Ω–∏—é –Ω–∞ –ø–ª–∞—à–∫—É):
  ```
  N. <–ù–∞–∑–≤–∞–Ω–∏–µ> [#tag1 #tag2] (id 689..., 2025‚Äë09‚Äë16)
  ```
  - –≠—Ç–æ **—Ç–µ–∫—Å—Ç**, –Ω–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞.
  - –¢–µ–≥–∏ ‚Äî –∫–æ—Ä–æ—Ç–∫–æ; –¥–∞—Ç–∞ ‚Äî –∫–æ—Ä–æ—Ç–∫–æ; id –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω.
- –ü–æ–¥ –∫–∞–∂–¥–æ–π –ø–ª–∞—à–∫–æ–π **–æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞** –∫–Ω–æ–ø–æ–∫:
  - `‚ûï`/`‚úÖ` ‚Äî —Ç—É–º–±–ª–µ—Ä –≤—ã–±–æ—Ä–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞ –º–µ—Å—Ç–µ).
  - `üóë` ‚Äî —É–¥–∞–ª–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–ø–∞–ø–æ–º; –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è: ¬´–£–¥–∞–ª–µ–Ω–æ¬ª ‚Üí —É–±—Ä–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ).

### 3.3 –§—É—Ç–µ—Ä (–ø–∞–≥–∏–Ω–∞—Ü–∏—è)
- –û—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ‚Äë—Ñ—É—Ç–µ—Ä: `‚¨ÖÔ∏è –ù–∞–∑–∞–¥ ‚Ä¢ –°—Ç—Ä. X/Y ‚Ä¢ –î–∞–ª–µ–µ ‚û°Ô∏è`.
- –ö–ª–∏–∫ –ø–æ `‚û°Ô∏è`:
  - —É–¥–∞–ª–∏—Ç—å 5 —Å–æ–æ–±—â–µ–Ω–∏–π —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã + —Ñ—É—Ç–µ—Ä;
  - –æ—Ç—Ä–∏—Å–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é –ø—è—Ç—ë—Ä–∫—É + –Ω–æ–≤—ã–π —Ñ—É—Ç–µ—Ä.
- –ö–ª–∏–∫ –ø–æ `‚¨ÖÔ∏è` ‚Äî —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ.

### 3.4 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- –ö–∞–∂–¥–∞—è –ø–ª–∞—à–∫–∞ ‚Äî –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –∏–Ω–ª–∞–π–Ω‚Äë–∫–ª–∞–≤–æ–π.
- –¢—É–º–±–ª–µ—Ä —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç **—Ç–æ–ª—å–∫–æ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É** —Å–≤–æ–µ–π –ø–ª–∞—à–∫–∏ (`edit_reply_markup`), –±–µ–∑ ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª.
- –õ—é–±—ã–µ ForceReply‚Äë–≤–≤–æ–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–¥–∞–ª—è—é—Ç—Å—è ¬´–º—è–≥–∫–æ¬ª —á–µ—Ä–µ–∑ –∑–∞–¥–µ—Ä–∂–∫—É.

---

## 4) –ü–æ–∏—Å–∫ (–≤–Ω—É—Ç—Ä–∏ List)

–ü–∞—Ä—Å–∏–Ω–≥:
- `^\d+$` ‚Üí –ø–æ–∏—Å–∫ –ø–æ `id` (—Ç–æ—á–Ω–æ–µ).
- `^#(.+)$` ‚Üí –ø–æ–∏—Å–∫ –ø–æ —Ç–µ–≥–∞–º: `lower(tag) LIKE %term%`.
- –ò–Ω–∞—á–µ ‚Üí –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é: `lower(title) LIKE %term%`.

–í—ã–¥–∞—á–∞: —Ç–æ—Ç –∂–µ List (5/—Å—Ç—Ä–∞–Ω–∏—Ü–∞) —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π.  
**LLM –Ω–µ –∑–≤–∞—Ç—å. Chat: OFF ‚Äî –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç.**

---

## 5) –ü—Ä–æ–µ–∫—Ç—ã –∏ linked‚Äë–ø—Ä–æ–µ–∫—Ç—ã

- –í—Å–µ–≥–¥–∞ –µ—Å—Ç—å **–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–µ–∫—Ç** (–≤ —Ö–µ–¥–µ—Ä–µ ASK –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ–≥–æ –∏–º—è).  
- –≠–∫—Ä–∞–Ω List/–ø–æ–∏—Å–∫/–≤—ã–±–æ—Ä –æ—Ç–Ω–æ—Å—è—Ç—Å—è **–∫ –∞–∫—Ç–∏–≤–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—É**.
- **Linked‚Äë–ø—Ä–æ–µ–∫—Ç—ã**: –Ω–∞–±–æ—Ä –ø—Ä–æ–µ–∫—Ç–æ–≤ ¬´—Å–≤—è–∑–∞–Ω¬ª (–æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–π –ø—É–ª –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞).  
  - –ü—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –ª–∏–Ω–∫–æ–≤–∫–µ **–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–∞ —á–∞—Ç–æ–≤ –∑–∞–ø—Ä–µ—â–µ–Ω–æ** (read‚Äëonly), —á—Ç–æ–±—ã –Ω–µ –ª–æ–º–∞—Ç—å —á—É–∂–∏–µ —Å–≤—è–∑–∏.  
  - –ß—Ç–æ–±—ã –ø—Ä–∞–≤–∏—Ç—å —Å–æ—Å—Ç–∞–≤ —á–∞—Ç–æ–≤ ‚Äî –≤—ã–±–∏—Ä–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –∞–∫—Ç–∏–≤–Ω—ã–º **–±–µ–∑** –ª–∏–Ω–∫–æ–≤–∫–∏; —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º; –∑–∞—Ç–µ–º —Å–Ω–æ–≤–∞ —Å–≤—è–∑—ã–≤–∞–µ–º –ø—Ä–æ–µ–∫—Ç—ã.  
  - –í ASK –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –±–µ–π–¥–∂ ¬´Linked: ON¬ª –∏ –ø–æ–¥—Å–∫–∞–∑–∫—É, –∫–∞–∫ –≤—ã–∫–ª—é—á–∏—Ç—å –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

–°–æ—Å—Ç–æ—è–Ω–∏–µ:
- `active_project_id`  
- `linked_project_ids: list[int]` (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º)  
- `selected_artifact_ids: list[int]` (–≤ —Ä–∞–º–∫–∞—Ö –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–æ–≥–æ –ø—É–ª–∞)  

–ü—Ä–∞–≤–∫–∏ –ø–æ UX:
- –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞ –ª–∏–Ω–∫–æ–≤–∫–∞ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å ¬´üîí –°–æ—Å—Ç–∞–≤ —á–∞—Ç–æ–≤ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (Linked ON)¬ª. –ö–Ω–æ–ø–∫–∏ `‚ûï/‚úÖ/üóë` –æ—Å—Ç–∞—é—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤—ã–±–æ—Ä–∞ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞, –Ω–æ **–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —á–∞—Ç–æ–≤** ‚Äî –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –∏–∑ —ç—Ç–æ–≥–æ —ç–∫—Ä–∞–Ω–∞.

---

## 6) Auto‚Äëclear (—Å–µ–º–∞–Ω—Ç–∏–∫–∞)

- `Auto‚Äëclear: ON` ‚Äî –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ `‚ùì Ask` —Å–ø–∏—Å–æ–∫ `selected_artifact_ids` **–æ—á–∏—â–∞–µ—Ç—Å—è**.  
- `OFF` ‚Äî –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–∞—Ö.  
- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –º–µ–Ω—è–µ—Ç—Å—è –≤ –¥–æ–º–∞—à–Ω–µ–π –ø–∞–Ω–µ–ª–∏ ASK; –≤ —Ñ—É—Ç–µ—Ä–µ List –Ω–µ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è.

---

## 7) –ë—é–¥–∂–µ—Ç (–ø–ª–∞—à–∫–∞)

- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥—Ä—É–±—É—é –æ—Ü–µ–Ω–∫—É `~N —Ç–æ–∫–µ–Ω–æ–≤` –Ω–∞ –æ—Ç–≤–µ—Ç –ø—Ä–∏ —Ç–µ–∫—É—â–µ–º –Ω–∞–±–æ—Ä–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.
- –†–∞—Å—á—ë—Ç ‚Äî —á–µ—Ä–µ–∑ —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ä–µ–∑—é–º–µ/–∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ).
- –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ç—É–º–±–ª–µ—Ä–µ/–∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤—ã–±–æ—Ä–∞.

---

## 8) –°—Ç–µ–π—Ç‚Äë–º–∞—à–∏–Ω–∞ (—Ñ–ª–∞–≥–∏ –∏ –ø–æ–ª—è)

- `awaiting_ask_search: bool` ‚Äî –∂–¥—ë–º –≤–≤–æ–¥ —Ç–µ—Ä–º–∏–Ω–∞ –ø–æ–∏—Å–∫–∞ (–≤–Ω—É—Ç—Ä–∏ List).  
- `selected_artifact_ids: list[int]` ‚Äî —Ç–µ–∫—É—â–∏–π –≤—ã–±–æ—Ä.  
- `ask_page: int`, `ask_total_pages: int` ‚Äî –ø–∞–≥–∏–Ω–∞—Ü–∏—è List.  
- `active_project_id: int`, `linked_project_ids: list[int]` ‚Äî –ø—Ä–æ–µ–∫—Ç—ã.  
- `auto_clear_selection: bool` ‚Äî —Ä–µ–∂–∏–º –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞.  
- `ask_page_msg_ids: list[int]`, `ask_footer_msg_id: int` ‚Äî id —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è —á–∏—Å—Ç–æ–π –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏.

**–ü—Ä–∞–≤–∏–ª–æ catch‚Äëall:** –∫–æ–≥–¥–∞ `awaiting_ask_search=True`, —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ö–µ–Ω–¥–ª–µ—Ä **–º–æ–ª—á–∏—Ç**.

---

## 9) SQL –∏ –∞–Ω—Ç–∏‚Äë–¥—É–±–ª–∏

- –û–±—è–∑–∞—Ç–µ–ª–µ–Ω ¬´–í–∞—Ä–∏–∞–Ω—Ç B¬ª: –ø–æ–¥–∑–∞–ø—Ä–æ—Å `sub(id)` —Å `distinct` –∏ –≤—Å–µ–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ (–≤ —Ç.—á. –ø–æ —Ç–µ–≥–∞–º), –∑–∞—Ç–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—Ä–æ—Å –ø–æ `id in (sub)` + `order by created_at desc` + –ø–∞–≥–∏–Ω–∞—Ü–∏—è `limit/offset`.
- –ù–∞ UI‚Äë—Å–ª–æ–µ ‚Äî —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞: —É–Ω–∏–∫–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ `artifact.id` –ø–µ—Ä–µ–¥ —Ä–µ–Ω–¥–µ—Ä–æ–º.
- –ò–Ω–¥–µ–∫—Å—ã: `(project_id, created_at)` –∏ –¥–ª—è —Ç–µ–≥–æ–≤ `(project_id, tag_name, artifact_id)`.

---

## 10) LLM: –∑–∞–ø—Ä–µ—Ç –≤ —ç—Ç–æ–º –ø–æ—Ç–æ–∫–µ

- –í List/–ø–æ–∏—Å–∫–µ/–ø–∞–≥–∏–Ω–∞—Ü–∏–∏/—Ç—É–º–±–ª–µ—Ä–µ/—É–¥–∞–ª–µ–Ω–∏–∏/–∏–º–ø–æ—Ä—Ç–µ ‚Äî **–Ω–æ–ª—å** –≤—ã–∑–æ–≤–æ–≤ LLM.  
- –ü—Ä–∏ –≤–∫–ª—é—á—ë–Ω–Ω–æ–º `LLM_DISABLED=1` ‚Äî –Ω–∏–∫–∞–∫–∏–µ –∫–Ω–æ–ø–∫–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã ¬´–ø—ã—Ç–∞—Ç—å—Å—è¬ª –∑–≤–∞—Ç—å –º–æ–¥–µ–ª—å.  
- `‚ùì Ask` ‚Äî _–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è_ —Ç–æ—á–∫–∞ –≤—ã–∑–æ–≤–∞ LLM (–≤–Ω–µ —Ä–∞–º–æ–∫ —ç—Ç–æ–π –∑–∞–¥–∞—á–∏).

---

## 11) –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∏ –ø–æ—Ä—è–¥–æ–∫ —Ä–æ—É—Ç–µ—Ä–æ–≤

1) Reply‚Äë–∫–ª–∞–≤–∞ / Actions / Chat / **ASK‚ÄëWIZARD** (—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞).  
2) –í–∏–∑–∞—Ä–¥—ã/–ø—Ä–æ—Ü–µ—Å—Å—ã (ASK, –≤–∫–ª—é—á–∞—è List).  
3) –ü–∞–Ω–µ–ª–∏/–º–µ–Ω—é –æ–±—â–∏–µ.  
4) **–ü–æ—Å–ª–µ–¥–Ω–∏–º** ‚Äî catch‚Äëall —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.

–°–ª—É–∂–µ–±–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã –≤ –µ–¥–∏–Ω–æ–º —Å–ø–∏—Å–∫–µ –∏ **–∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è** catch‚Äëall.

---

## 12) –ú–∏–≥—Ä–∞—Ü–∏–∏/–º–æ–¥–µ–ª–∏ (–µ—Å–ª–∏ –Ω–µ—Ç –ø–æ–ª–µ–π)

- `awaiting_ask_search boolean NOT NULL DEFAULT false`
- `selected_artifact_ids text/jsonb NOT NULL DEFAULT '[]'`
- `ask_page int NOT NULL DEFAULT 1`
- `ask_total_pages int NOT NULL DEFAULT 1`
- `ask_page_msg_ids text/jsonb NOT NULL DEFAULT '[]'`
- `ask_footer_msg_id bigint NULL`
- `active_project_id bigint NULL`
- `linked_project_ids text/jsonb NOT NULL DEFAULT '[]'`
- `auto_clear_selection boolean NOT NULL DEFAULT true`

(–ù–∞–∑–≤–∞–Ω–∏—è ‚Äî –ø–æ–¥ –≤–∞—à–∏ –º–æ–¥–µ–ª–∏; —Ç–∏–ø—ã jsonb/bigint ‚Äî –ø–æ —Ñ–∞–∫—Ç—É.)

---

## 13) Acceptance (—á—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º ¬´–≤–∂–∏–≤—É—é¬ª)

1) –ò–∑ Reply‚Äë–∫–ª–∞–≤—ã ‚Äî **—Ç–æ–ª—å–∫–æ** `‚öôÔ∏è Actions`, `üí¨ Chat ON/OFF`, `‚ùì ASK‚ÄëWIZARD`.  
2) –î–æ–º–∞—à–Ω—è—è –ø–∞–Ω–µ–ª—å ASK: –µ—Å—Ç—å –±—é–¥–∂–µ—Ç, `Auto‚Äëclear`, `Import last`, **–±–µ–∑ Memory**.  
3) –≠–∫—Ä–∞–Ω List –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 5 –ø–ª–∞—à–µ–∫; —É –∫–∞–∂–¥–æ–π ‚Äî **–æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞** `‚ûï/‚úÖ, üóë`.  
4) `‚ûï` –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è `‚úÖ` (–æ–±—Ä–∞—Ç–Ω–æ ‚Äî —Ç–∞–∫ –∂–µ), **–±–µ–∑** ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª.  
5) `üîç` –≤ —à–∞–ø–∫–µ List:  
   - `plan` ‚Üí —Å–ø–∏—Å–æ–∫;  
   - `#woman` ‚Üí —Å–ø–∏—Å–æ–∫;  
   - `12` ‚Üí –æ–¥–Ω–∞ –ø–ª–∞—à–∫–∞.  
   Chat: OFF, LLM –Ω–µ –∑–æ–≤—ë—Ç—Å—è.  
6) `‚¨ÖÔ∏è/‚û°Ô∏è` –≤—Å–µ–≥–¥–∞ –¥–µ—Ä–∂–∞—Ç –Ω–∞ —ç–∫—Ä–∞–Ω–µ —Ä–æ–≤–Ω–æ 5 –ø–ª–∞—à–µ–∫; —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —É–¥–∞–ª—è—é—Ç—Å—è.  
7) Linked: –ø—Ä–∏ –≤–∫–ª—é—á—ë–Ω–Ω–æ–π –ª–∏–Ω–∫–æ–≤–∫–µ –ø–æ–ø—ã—Ç–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—å —Å–æ—Å—Ç–∞–≤ —á–∞—Ç–æ–≤ –∏–∑ ASK –Ω–µ –¥–∞—ë—Ç —Ç–∞–∫–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (read‚Äëonly –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ).  
8) `Auto‚Äëclear: ON`: –ø–æ—Å–ª–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ `‚ùì Ask` –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –æ—á–∏—â–∞—é—Ç—Å—è; –ø—Ä–∏ `OFF` ‚Äî –æ—Å—Ç–∞—é—Ç—Å—è.

---

## 14) –í—ã–¥–∞—á–∞ –Ω–∞ –≤—ã—Ö–æ–¥–µ (–æ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞)

- –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã ASK (–≤–∫–ª—é—á–∞—è List), —É–¥–∞–ª—ë–Ω–Ω—ã–µ/–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏ Memory.  
- –û–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è Reply‚Äë–∫–ª–∞–≤–∞.  
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø–æ–ª–µ–π.  
- –ö–æ—Ä–æ—Ç–∫–∞—è –∑–∞–ø–∏—Å–∫–∞ ¬´–≥–¥–µ —á—Ç–æ –ø—Ä–∞–≤–∏–ª–∏¬ª, –∏ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –ø—É–Ω–∫—Ç—ã –∏–∑ **Acceptance**.

---

## 15) –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –ø–æ –∏–∫–æ–Ω–∫–∞–º

- –¢—É–º–±–ª–µ—Ä: `‚ûï` ‚Üí `‚úÖ`.  
- –£–¥–∞–ª–µ–Ω–∏–µ: `üóë`; –ø–∞–≥–∏–Ω–∞—Ü–∏—è: `‚¨ÖÔ∏è/‚û°Ô∏è`; ¬´–Ω–∞–∑–∞–¥ –≤ –º–µ–Ω—é¬ª –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏: `‚Ü©Ô∏è`.
